(()=>{"use strict";const e={0:[{displayableText:!0,changeable:!0,keyCode:"Backquote",keyEn:["`","~"],keyRu:["ё","Ё"]},{displayableText:!0,changeable:!0,keyCode:"Digit1",keyEn:["1","!"],keyRu:["1","!"]},{displayableText:!0,changeable:!0,keyCode:"Digit2",keyEn:["2","@"],keyRu:["2",'"']},{displayableText:!0,changeable:!0,keyCode:"Digit3",keyEn:["3","#"],keyRu:["3","№"]},{displayableText:!0,changeable:!0,keyCode:"Digit4",keyEn:["4","$"],keyRu:["4",";"]},{displayableText:!0,changeable:!0,keyCode:"Digit5",keyEn:["5","%"],keyRu:["5","%"]},{displayableText:!0,changeable:!0,keyCode:"Digit6",keyEn:["6","^"],keyRu:["6","?"]},{displayableText:!0,changeable:!0,keyCode:"Digit7",keyEn:["7","&"],keyRu:["7","?"]},{displayableText:!0,changeable:!0,keyCode:"Digit8",keyEn:["8","*"],keyRu:["8","*"]},{displayableText:!0,changeable:!0,keyCode:"Digit9",keyEn:["9","("],keyRu:["9","("]},{displayableText:!0,changeable:!0,keyCode:"Digit0",keyEn:["0",")"],keyRu:["0",")"]},{displayableText:!0,changeable:!0,keyCode:"Minus",keyEn:["-","_"],keyRu:["-","_"]},{displayableText:!0,changeable:!0,keyCode:"Equal",keyEn:["=","+"],keyRu:["=","+"]},{displayableText:!1,changeable:!1,keyCode:"Backspace",keyEn:"Backspace",keyRu:"Backspace"}],1:[{displayableText:!1,changeable:!1,keyCode:"Tab",keyEn:"Tab",keyRu:"Tab"},{displayableText:!0,changeable:!0,keyCode:"KeyQ",keyEn:["q","Q"],keyRu:["й","Й"]},{displayableText:!0,changeable:!0,keyCode:"KeyW",keyEn:["w","W"],keyRu:["ц","Ц"]},{displayableText:!0,changeable:!0,keyCode:"KeyE",keyEn:["e","E"],keyRu:["у","У"]},{displayableText:!0,changeable:!0,keyCode:"KeyR",keyEn:["r","R"],keyRu:["к","К"]},{displayableText:!0,changeable:!0,keyCode:"KeyT",keyEn:["t","T"],keyRu:["е","Е"]},{displayableText:!0,changeable:!0,keyCode:"KeyY",keyEn:["y","Y"],keyRu:["н","Н"]},{displayableText:!0,changeable:!0,keyCode:"KeyU",keyEn:["u","U"],keyRu:["г","Г"]},{displayableText:!0,changeable:!0,keyCode:"KeyI",keyEn:["i","I"],keyRu:["ш","Ш"]},{displayableText:!0,changeable:!0,keyCode:"KeyO",keyEn:["o","O"],keyRu:["щ","Щ"]},{displayableText:!0,changeable:!0,keyCode:"KeyP",keyEn:["p","P"],keyRu:["з","З"]},{displayableText:!0,changeable:!0,keyCode:"BracketLeft",keyEn:["[","{"],keyRu:["х","Х"]},{displayableText:!0,changeable:!0,keyCode:"BracketRight",keyEn:["]","}"],keyRu:["ъ","Ъ"]},{displayableText:!1,changeable:!1,keyCode:"Delete",keyEn:"Delete",keyRu:"Delete"}],2:[{displayableText:!1,changeable:!1,keyCode:"CapsLock",keyEn:"CapsLock",keyRu:"CapsLock"},{displayableText:!0,changeable:!0,keyCode:"KeyA",keyEn:["a","A"],keyRu:["ф","Ф"]},{displayableText:!0,changeable:!0,keyCode:"KeyS",keyEn:["s","S"],keyRu:["ы","Ы"]},{displayableText:!0,changeable:!0,keyCode:"KeyD",keyEn:["d","D"],keyRu:["в","В"]},{displayableText:!0,changeable:!0,keyCode:"KeyF",keyEn:["f","F"],keyRu:["а","А"]},{displayableText:!0,changeable:!0,keyCode:"KeyG",keyEn:["g","G"],keyRu:["п","П"]},{displayableText:!0,changeable:!0,keyCode:"KeyH",keyEn:["h","H"],keyRu:["р","Р"]},{displayableText:!0,changeable:!0,keyCode:"KeyJ",keyEn:["j","J"],keyRu:["о","О"]},{displayableText:!0,changeable:!0,keyCode:"KeyK",keyEn:["k","K"],keyRu:["л","Л"]},{displayableText:!0,changeable:!0,keyCode:"KeyL",keyEn:["l","L"],keyRu:["д","Д"]},{displayableText:!0,changeable:!0,keyCode:"Semicolon",keyEn:[";",":"],keyRu:["ж","Ж"]},{displayableText:!0,changeable:!0,keyCode:"Quote",keyEn:["'",'"'],keyRu:["э","Э"]},{displayableText:!1,changeable:!1,keyCode:"Enter",keyEn:"Enter",keyRu:"Enter"}],3:[{displayableText:!1,changeable:!1,keyCode:"ShiftLeft",keyEn:"Shift",keyRu:"Shift"},{displayableText:!0,changeable:!0,keyCode:"Backslash",keyEn:["\\","|"],keyRu:["\\","/"]},{displayableText:!0,changeable:!0,keyCode:"KeyZ",keyEn:["z","Z"],keyRu:["я","Я"]},{displayableText:!0,changeable:!0,keyCode:"KeyX",keyEn:["x","X"],keyRu:["ч","Ч"]},{displayableText:!0,changeable:!0,keyCode:"KeyC",keyEn:["c","C"],keyRu:["с","С"]},{displayableText:!0,changeable:!0,keyCode:"KeyV",keyEn:["v","V"],keyRu:["м","М"]},{displayableText:!0,changeable:!0,keyCode:"KeyB",keyEn:["b","B"],keyRu:["и","И"]},{displayableText:!0,changeable:!0,keyCode:"KeyN",keyEn:["n","N"],keyRu:["т","Т"]},{displayableText:!0,changeable:!0,keyCode:"KeyM",keyEn:["m","M"],keyRu:["ь","Ь"]},{displayableText:!0,changeable:!0,keyCode:"Comma",keyEn:[",","<"],keyRu:["б","Б"]},{displayableText:!0,changeable:!0,keyCode:"Period",keyEn:[".",">"],keyRu:["ю","Ю"]},{displayableText:!0,changeable:!0,keyCode:"Slash",keyEn:["/","?"],keyRu:[".",","]},{displayableText:!1,changeable:!1,keyCode:"ArrowUp",keyEn:"↑",keyRu:"↑"},{displayableText:!1,changeable:!1,keyCode:"ShiftRight",keyEn:"Shift",keyRu:"Shift"}],4:[{displayableText:!1,changeable:!1,keyCode:"ControlLeft",keyEn:"Ctrl",keyRu:"Ctrl"},{displayableText:!1,changeable:!0,keyCode:"Language",keyEn:["EN","EN"],keyRu:["RU","RU"]},{displayableText:!1,changeable:!1,keyCode:"AltLeft",keyEn:"Alt",keyRu:"Alt"},{displayableText:!0,changeable:!1,keyCode:"Space",keyEn:" ",keyRu:" "},{displayableText:!1,changeable:!1,keyCode:"AltRight",keyEn:"Alt",keyRu:"Alt"},{displayableText:!1,changeable:!1,keyCode:"ControlRight",keyEn:"Ctrl",keyRu:"Ctrl"},{displayableText:!1,changeable:!1,keyCode:"ArrowLeft",keyEn:"←",keyRu:"←"},{displayableText:!1,changeable:!1,keyCode:"ArrowDown",keyEn:"↓",keyRu:"↓"},{displayableText:!1,changeable:!1,keyCode:"ArrowRight",keyEn:"→",keyRu:"→"}]},a=[["h1","title","Virtual Keyboard for Windows"],["textarea","textarea",""],["div","keyboard",""],["h2","information","Hotkeys for change language: LeftAlt and LeftShift"],["h2","attention attention_disable","Caps Lock is active"]];function t(){return localStorage.getItem("virtual_keyboard.language")||localStorage.setItem("virtual_keyboard.language","En"),localStorage.getItem("virtual_keyboard.language")}function n(){return Number(localStorage.getItem("virtual_keyboard.capsLock"))}function l(){return[document.querySelector(".textarea").selectionStart,document.querySelector(".textarea").selectionEnd]}function y(e,a){const t=document.querySelector(".textarea"),n=t.value.length,[l,y]=a;l!==n?(t.value=t.value.slice(0,l)+e+t.value.slice(y,n),t.setSelectionRange(l+1,l+1)):l===n&&(t.value+=e,t.setSelectionRange(t.value.length,t.value.length))}function o(e,a){const t=document.querySelector(".textarea");let[n,l]=a;"Delete"===e&&n===l?l+=1:"Delete"!==e&&n===l&&(n-=1);const y=t.value.split("");y.splice(n,l-n),t.value=y.join(""),t.setSelectionRange(n,n)}function c(e){return localStorage.setItem("virtual_keyboard.language",e),localStorage.getItem("virtual_keyboard.language")}function k(){const a="Ru"===t()?c("En"):c("Ru");Object.values(e).forEach((e=>{e.forEach((e=>{e.changeable&&(n()?document.querySelector(`#${e.keyCode}`).innerText=e[`key${a}`][0].toUpperCase():document.querySelector(`#${e.keyCode}`).innerText=e[`key${a}`][0].toLowerCase())}))})),document.querySelector("#Language").innerText=a.toUpperCase()}function d(a,n){if(a.altKey)k();else{const a=t();Object.values(e).forEach((e=>{e.forEach((e=>{e.changeable&&n&&"Language"!==document.querySelector(`#${e.keyCode}`)?document.querySelector(`#${e.keyCode}`).innerText=e[`key${a}`][1].toLowerCase():e.changeable&&!n&&"Language"!==document.querySelector(`#${e.keyCode}`)&&(document.querySelector(`#${e.keyCode}`).innerText=e[`key${a}`][1].toUpperCase())}))})),document.querySelector("#Language").innerText=a.toUpperCase()}}function r(a,n){if(!a.altKey){const a=t();Object.values(e).forEach((e=>{e.forEach((e=>{e.changeable&&n&&"Language"!==document.querySelector(`#${e.keyCode}`)?document.querySelector(`#${e.keyCode}`).innerText=e[`key${a}`][0].toUpperCase():e.changeable&&!n&&"Language"!==document.querySelector(`#${e.keyCode}`)&&(document.querySelector(`#${e.keyCode}`).innerText=e[`key${a}`][0].toLowerCase())}))})),document.querySelector("#Language").innerText=a.toUpperCase()}}function i(a){const n=t();Object.values(e).forEach((e=>{e.forEach((e=>{e.changeable&&1===a&&"Language"!==e.keyCode?document.querySelector(`#${e.keyCode}`).innerText=e[`key${n}`][0].toUpperCase():e.changeable&&0===a&&"Language"!==e.keyCode&&(document.querySelector(`#${e.keyCode}`).innerText=e[`key${n}`][0].toLowerCase())}))}))}function u(e){if(null!==document.querySelector(`#${e.code}`)){document.querySelector(`#${e.code}`).classList.add("keyboard__key_active","keyboard__key_click");const a=document.querySelector(`#${e.code}`).innerText;1===e.key.length||"Space"===e.key?(e.preventDefault(),y(a,l())):"Tab"===e.keyCode?(e.preventDefault(),y("    ",l())):"Backspace"===e.key?(e.preventDefault(),o("Backspace",l())):"Delete"===e.key?(e.preventDefault(),o("Delete",l())):"CapsLock"===e.key?(e.preventDefault(),localStorage.setItem("virtual_keyboard.capsLock",n()?0:1),i(n())):"Shift"===e.key?(e.preventDefault(),d(e,n())):"Control"===e.key?e.preventDefault():"Alt"===e.key?(e.preventDefault(),e.shiftKey&&k()):"Enter"===e.key&&(e.preventDefault(),y("\n",l()))}}function s(e){null!==document.querySelector(`#${e.code}`)&&(document.querySelector(`#${e.code}`).classList.remove("keyboard__key_active","keyboard__key_click"),"Shift"===e.key?(e.preventDefault(),r(e,n())):"CapsLock"===e.key&&(n()?document.querySelector(".attention").classList.remove("attention_disable"):document.querySelector(".attention").classList.add("attention_disable")))}function b(e){const a=[];return e.split("\n").forEach((e=>{const t=e.split("");if(t.length>90){for(;t.length>90;)a.push(t.splice(0,90).join(""));a.push(t.join(""))}else a.push(e)})),a.map((e=>`${e}\n`))}function g(e){if("button"===e.target.type){const a="Space"===e.target.id?" ":e.target.innerText,t=["↑","←","↓","→"];document.querySelector(".textarea").focus(),document.querySelector(`#${e.target.id}`).classList.add("keyboard__key_active","keyboard__key_click"),1===e.target.innerText.length&&!t.includes(e.target.innerText)||"Space"===e.target.id?y(a,l()):"Tab"===a?y("    ",l()):"Backspace"===a?o("Backspace",l()):"Delete"===a?o("Delete",l()):"CapsLock"===a?(localStorage.setItem("virtual_keyboard.capsLock",n()?0:1),i(n())):"Shift"===a?d(e,n()):"Alt"===a?e.shifKey&&k():"Enter"===a?y("\n",l()):"Language"===e.target.id?k():t.includes(e.target.innerText)&&function(e,a){const t=document.querySelector(".textarea"),n=t.value,[l,y]=a;let o=l;if(l===y){if("↑"===e){const e=b(n.slice(0,l));if(e.length>1)if(e[e.length-2].length<e[e.length-1].length){const a=e[e.length-1].length;t.setSelectionRange(l-a,l-a)}else o-=e[e.length-2].length-!n.slice(0,l).includes("\n"),t.setSelectionRange(o,o);else{const e=n.slice(0,l).length;t.setSelectionRange(l-e,l-e)}}else if("←"===e)t.setSelectionRange(l-1,l-1);else if("→"===e)t.setSelectionRange(l+1,l+1);else if("↓"===e){const e=b(n.slice(0,l)),a=b(n);if(e.length<a.length)t.setSelectionRange(l+90,l+90);else{const e=n.slice(0,l).length;t.setSelectionRange(l+e,l+e)}}}else"←"===e||"↑"===e?t.setSelectionRange(l,l):"→"!==e&&"↓"!==e||t.setSelectionRange(y,y)}(e.target.innerText,l())}}function p(a){"button"===a.target.type?(document.querySelector(`#${a.target.id}`).classList.remove("keyboard__key_active","keyboard__key_click"),document.querySelector(".textarea").focus(),"Shift"===a.target.innerText?r(a,n()):"CapsLock"===a.target.innerText?(document.querySelector(`#${a.target.id}`).classList.remove("keyboard__key_active","keyboard__key_click"),n()?document.querySelector(".attention").classList.remove("attention_disable"):document.querySelector(".attention").classList.add("attention_disable")):document.querySelector(`#${a.target.id}`).classList.remove("keyboard__key_active","keyboard__key_click")):Object.values(e).forEach((e=>{e.forEach((e=>{"CapsLock"!==document.querySelector(`#${e.keyCode}`)&&document.querySelector(`#${e.keyCode}`).classList.remove("keyboard__key_active","keyboard__key_click")}))}))}document.addEventListener("DOMContentLoaded",(()=>{document.body.appendChild(function(e){const a=document.createElement("div");return a.className="wrapper",e.forEach((e=>{const t=document.createElement(e[0]);[,t.className,t.innerText]=e,a.append(t)})),a}(a)),function(e,a="En"){const t=document.querySelector(".keyboard");localStorage.setItem("virtual_keyboard.capsLock","0"),Object.values(e).forEach(((e,n)=>{const l=document.createElement("div");l.className=`keyboard__row keyboard__row_${n}`,e.forEach((e=>{const t=document.createElement("button");t.className="keyboard__key",t.type="button",t.setAttribute("data-displayableText",e.displayableText),t.id=e.keyCode,t.innerText=e.changeable?e[`key${a}`][0]:e.keyEn,l.append(t)})),t.append(l)}))}(e,t()),document.addEventListener("keydown",u),document.addEventListener("keyup",s),document.querySelector(".keyboard").addEventListener("mousedown",g),document.querySelector(".keyboard").addEventListener("mouseup",p)}))})();